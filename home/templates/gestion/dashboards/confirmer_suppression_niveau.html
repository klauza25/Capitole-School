{% extends "gestion/base.html" %}
{% load static %}
{% block title %}Confirmer la suppression - Capitole School{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- En-tête -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 text-dark">⚠️ Confirmer la suppression</h1>
        <a href="{% url 'home:liste_niveaux' %}" class="btn btn-secondary">← Retour</a>
    </div>

    <!-- Alerte -->
    <div class="alert alert-danger">
        <h4 class="alert-heading">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Êtes-vous sûr ?
        </h4>
        <p>
            Vous êtes sur le point de supprimer le niveau suivant :
        </p>
        <div class="bg-light p-3 rounded mb-3">
            <strong>Niveau :</strong> <span class="text-primary">{{ niveau.nom }}</span><br>
            <strong>Cycle :</strong> {{ niveau.cycle.nom }}
        </div>
        <p class="mb-0">
            <strong class="text-danger">Cette action est irréversible.</strong><br>
            Toutes les classes, notes et données liées à ce niveau seront supprimées.
        </p>
    </div>

    <!-- Formulaire de confirmation -->
    <form method="post">
        {% csrf_token %}
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-danger btn-lg">
                <i class="fas fa-trash me-2"></i> Oui, supprimer définitivement
            </button>
            <a href="{% url 'home:liste_niveaux' %}" class="btn btn-secondary btn-lg">
                <i class="fas fa-times me-2"></i> Annuler
            </a>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Active le lien "Niveaux" dans la sidebar
    document.querySelectorAll('.sidebar .nav-link').forEach(link => {
        if (link.getAttribute('href') === '/niveaux/') {
            link.classList.add('active');
        }
    });

    // Demande de confirmation supplémentaire
    document.querySelector('form').addEventListener('submit', function(e) {
        const confirmed = confirm("⚠️ Êtes-vous ABSOLUMENT sûr de vouloir supprimer ce niveau ?\nCette action est irréversible.");
        if (!confirmed) {
            e.preventDefault();
        }
    });
</script>
{% endblock %}